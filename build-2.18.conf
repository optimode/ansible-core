# Sample build configuration for optibuild
#
# This is an example configuration file showing all available options.
# Copy this file to your project and customize as needed.

# ============================================================================
# REQUIRED FIELDS
# ============================================================================

# Path to project directory (where Dockerfile is located)
PROJECT_PATH="/Volumes/DevOps/Docker/optimode/github/ansible-core"

# Exact version to build (semver format recommended)
VERSION="2.18.11"

# Image name (without registry prefix)
IMAGE_NAME="optimode/ansible-core"

# ============================================================================
# OPTIONAL FIELDS (with defaults shown)
# ============================================================================

# Private registry (used as source of truth)
PRIVATE_REGISTRY="10.10.10.127:5000"

# Dockerfile name
DOCKERFILE="Dockerfile"

# Build context directory (relative to PROJECT_PATH)
BUILD_CONTEXT="."

# ============================================================================
# PLATFORM CONFIGURATION
# ============================================================================

# Local platform (auto-detected if empty)
# Examples: "linux/amd64", "linux/arm64"
LOCAL_PLATFORM="linux/arm64"

# Remote platform (auto-detected as opposite of local if empty)
REMOTE_PLATFORM="linux/amd64"

# Remote buildx builder name (empty = local builds only)
# Set this to enable cross-platform builds using a remote builder
REMOTE_BUILDER="malinal-arch-buildkit"

# Example for cross-platform builds:
# REMOTE_BUILDER="amd64-builder"

# ============================================================================
# TAGS
# ============================================================================

# Additional tags to create (beyond the VERSION tag)
# Each tag will be created for each platform, plus a multiplatform manifest
TAGS=(
    "2.18"
)

# ============================================================================
# BUILD ARGUMENTS
# ============================================================================

# Build arguments to pass to docker build
# These are passed as --build-arg to the build command
BUILD_ARGS=(
    "PYTHON_VERSION=3.11"
    "ANSIBLE_VERSION=2.18.11"
    "URL=https://optimode.hu/ansible-core"
    "SOURCE=https://github.com/optimode/ansible-core"
    "VENDOR=optimode"
    "REVISION="
    #"REVISION=$(git rev-parse --short HEAD)"
    "BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ')"
    "AUTHORS==Laszlo Malina <laszlo@optimode.hu>"
)

# ============================================================================
# DEPLOYMENT CONFIGURATION
# ============================================================================

# GitHub Container Registry deployment
GITHUB_ORG="optimode"           # Your GitHub organization or username
DEPLOY_TO_GITHUB=true           # Set to false to skip GitHub deployment

# Docker Hub deployment
DOCKERHUB_ORG="optimode"        # Your Docker Hub organization or username
DEPLOY_TO_DOCKERHUB=true        # Set to false to skip Docker Hub deployment

# ============================================================================
# USAGE
# ============================================================================
#
# Run all phases:
#   /path/to/optibuild all
#
# Run specific phases:
#   /path/to/optibuild build tag manifest
#
# Use custom config file:
#   /path/to/optibuild -c my.conf all
#
# Verbose output:
#   /path/to/optibuild --verbose build
#
